<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®åšå¿«ç…§åˆ—è¡¨</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 10px;
            background-color: #f9f9f9;
        }
        h1 { text-align: center; }
        input, button { margin: 5px 0; padding: 5px; width: 100%; }
        ul { list-style: none; padding: 0; }
        li {
            background: white;
            margin: 5px 0;
            padding: 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
        }
        a {
            text-decoration: none;
            color: #007bff;
            font-weight: bold;
            margin-right: 20px;
        }
        a:hover { text-decoration: underline; }
        img { max-width: 150px; height: auto; border-radius: 5px; }
        .content {
            display: flex;
            flex-direction: column;
        }
        .content h3 {
            margin: 5px 0;
        }
    </style>
</head>
<body>

    <h1>å¾®åšå¿«ç…§åˆ—è¡¨</h1>

    <input type="text" id="searchInput" placeholder="ğŸ” æœå°‹é—œéµå­—..." onkeyup="filterSnapshots()">
    <input type="date" id="startDate">
    <input type="date" id="endDate">
    <button onclick="filterByDate()">æŒ‰æ—¥æœŸç¯©é¸</button>

    <ul id="snapshotList">
        <!-- å¿«ç…§åˆ—è¡¨å°‡ç”± JavaScript è‡ªå‹•ç”Ÿæˆ -->
    </ul>

    <script>
        // åŠ è¼‰ snapshots.json
        async function loadSnapshots() {
            const response = await fetch('snapshots.json'); // å¾ GitHub Pages è®€å– JSON æ–‡ä»¶
            const snapshots = await response.json(); // è§£æ JSON

            const list = document.getElementById("snapshotList");
            list.innerHTML = ""; // æ¸…ç©ºç¾æœ‰å…§å®¹

            for (let snapshot of snapshots) {
                let li = document.createElement("li");

                // åŠ è¼‰ HTML æ–‡ä»¶ä¸¦æå–åœ–ç‰‡
                let htmlContent = await fetch(snapshot.html).then(res => res.text());
                let doc = new DOMParser().parseFromString(htmlContent, 'text/html');

                // æå– HTML ä¸­çš„æ‰€æœ‰åœ–ç‰‡ï¼ˆå‡è¨­æ‰€æœ‰åœ–ç‰‡éƒ½æ˜¯ <img> æ¨™ç±¤ï¼‰
                let images = Array.from(doc.querySelectorAll('img'));
                let imageElements = images.map(img => {
                    return `<img src="${img.src}" alt="åœ–ç‰‡" />`;
                }).join("");

                li.innerHTML = `
                    <div>
                        <a href="${snapshot.html}" target="_blank">${snapshot.date}</a>
                    </div>
                    <div class="content">
                        <h3>å¿«ç…§å…§å®¹: ${snapshot.date}</h3>
                        ${imageElements}
                    </div>
                `;
                list.appendChild(li);
            }
        }

        // æœå°‹å¿«ç…§
        function filterSnapshots() {
            let input = document.getElementById("searchInput").value.toLowerCase();
            let items = document.querySelectorAll("#snapshotList li");
            items.forEach(li => {
                let text = li.innerText.toLowerCase();
                li.style.display = text.includes(input) ? "" : "none";
            });
        }

        // æ ¹æ“šæ—¥æœŸç¯©é¸
        function filterByDate() {
            let start = document.getElementById("startDate").value;
            let end = document.getElementById("endDate").value;
            let items = document.querySelectorAll("#snapshotList li");
            items.forEach(li => {
                let date = li.innerText.substring(0, 10); // å–å‡ºæ—¥æœŸéƒ¨åˆ†
                li.style.display = (!start || date >= start) && (!end || date <= end) ? "" : "none";
            });
        }

        // é é¢è¼‰å…¥æ™‚é¡¯ç¤ºå¿«ç…§
        loadSnapshots();
    </script>

</body>
</html>
